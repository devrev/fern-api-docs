# Custom Objects

## Table of Contents

1. [Introduction](#custom-objects)
2. [Quick Start](#quick-start)
   - [Create a Schema and a Custom Object](#create-a-schema-and-a-custom-object)
   - [Get a Custom Object](#get-a-custom-object)
   - [List Custom Objects](#list-custom-objects)
   - [Update a Custom Object](#update-a-custom-object)
   - [Delete a Custom Object](#delete-a-custom-object)
3. [Key Concepts](#key-concepts)
4. [Custom Object Lifecycle](#custom-object-lifecycle)

- - -

## Introduction
Custom objects allow you to extend DevRev's data model beyond the standard use-cases served by the native apps (build, support, etc).
Custom Objects allow you to create and manage object types tailored to your specific business needs.

## Quick Start

Let's say you want to manage marketing campaigns on DevRev. We'll go through the process of creating a "Campaign" custom object with relevant fields.

All DevRev objects require a schema. So, we'll first create a schema for the "Campaign" custom object. Make sure to replace the `<YOUR_API_TOKEN>` with your actual API token.

### Create a Schema and a Custom Object

```
curl --location 'https://api.devrev.ai/schemas.custom.set' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "type": "tenant_fragment",
    "description": "Attributes for Campaign",
    "leaf_type": "campaign",
    "fields": [
        {
            "name": "name",
            "field_type": "tokens",
            "description": "Name of the campaign"
        },
        {
            "name": "start_date",
            "field_type": "date",
            "description": "Start date of the campaign"
        },
        {
            "name": "end_date",
            "field_type": "date",
            "description": "End date of the campaign"
        },
        {
            "name": "budget",
            "field_type": "int",
            "description": "Budget allocated for the campaign"
        },
        {
            "name": "target_audience",
            "field_type": "enum",
            "description": "Target audience for the campaign",
            "allowed_values": [
                "Professionals",
                "Students"
            ]
        }
    ],
    "is_custom_leaf_type": true,
    "id_prefix": "CAMP"
}'
```

Once the schema is created, you can create a custom object of type "Campaign":

```
curl --location 'https://api.devrev.ai/custom-objects.create' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "leaf_type": "campaign",
    "custom_fields": {
        "tnt__name": "Summer Sale 2023",
        "tnt__start_date": "2023-06-01",
        "tnt__end_date": "2023-08-31",
        "tnt__budget": 10000,
        "tnt__target_audience": "Professionals"
    },
    "unique_key": "CAMP-001"
}'
```

The response of the above API call will be the ID of the custom object created.
```
{
  "custom_object": {
    "id": "don:core:dvrv-us-1:devo/11FVC3ScK:custom_object/campaign/1",
    "created_by": {...},
    "created_date": "2024-10-01T07:02:58.958Z",
    "modified_by": {...},
    "modified_date": "2024-10-01T07:02:58.958Z",
    "display_id": "C-CAMP-1",
    "leaf_type": "campaign",
    "unique_key": "CAMP-001"
    "stock_schema_fragment": "don:core:dvrv-us-1:stock_sf/1522526",
    "custom_schema_fragments": [
      "don:core:dvrv-us-1:devo/11FVC3ScK:tenant_fragment/261"
    ],
    "custom_fields": {
      "tnt__budget": 10000,
      "tnt__end_date": "2023-08-31",
      "tnt__name": "Summer Sale 2023",
      "tnt__start_date": "2023-06-01",
      "tnt__target_audience": "Professionals"
    },
  }
}
```

Note that the `id` field in the above response is the system generated ID for the custom object.

The sections below provide more details on the available API endpoints for interacting with Custom Objects.

### Get a Custom Object

To get a custom object, use the `custom-objects.get` endpoint:

```
curl --location 'https://api.devrev.ai/custom-objects.get' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "id": "don:core:dvrv-us-1:devo/11FVC3ScK:custom_object/campaign/1"
}'
```

### List Custom Objects

To list custom objects, use the `custom-objects.list` endpoint:

```
curl --location 'https://api.devrev.ai/custom-objects.list' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "leaf_type": "campaign",
    "filter": [
      "eq",
      "$custom_fields.ctype__target_audience",
      "Young adults"
    ]
}'
```

### Update a Custom Object

To update an existing custom object, use the `custom-objects.update` endpoint.
The following example updates the budget of the previously created campaign custom object:

```
curl --location 'https://api.devrev.ai/custom-objects.update' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "id": "don:core:dvrv-us-1:devo/11FVC3ScK:custom_object/campaign/1",
    "custom_fields": {
        "tnt__budget": 15000
    }
}'
```

### Delete a Custom Object

To delete a custom object, use the `custom-objects.delete` endpoint.
The following example deletes the previously created campaign custom object:

```
curl --location 'https://api.devrev.ai/custom-objects.delete' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: <YOUR_API_TOKEN>' \
--data '{
    "id": "don:core:dvrv-us-1:devo/11FVC3ScK:custom_object/campaign/1"
}'
```

## Key Concepts

1. **Leaf Type**: The base type of your custom object (e.g., "campaign").
2. **Subtype**: A more specific categorization within a leaf type (e.g., "promotion" or "advertising" for a "campaign" leaf type).
3. **Custom Fields**: User-defined fields that store specific data for your custom object.
4. **Unique Key**: A unique identifier for each custom object, useful for maintaining idempotency.

For more details on customization concepts, please refer to the [Customization](./object-customization) documentation.

## Custom Object Lifecycle

1. **Creation**: Define the leaf type, subtype (optional), and custom fields for your custom object.
2. **Usage**: Create, update, and query custom objects as needed in your workflows.
3. **Management**: Modify the schema of the custom object as your needs evolve.
