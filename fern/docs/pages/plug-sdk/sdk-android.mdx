# Integrate PLuG SDKs with your Android app 

This section describes the process of integrating PLuG using the DevRev SDK with your Android app.

## Requirements

- Android Studio 2022.1.1 or later
- Android Gradle Plugin version 7.4 or later
- Gradle version 7.6 or later
- Minimum Android SDK 24

## Integration

To integrate the latest version of our SDK into your app, follow these steps:

<Tabs>
<Tab title="Kotlin">

1. Add the following dependencies to your app's `build.gradle.kts` file to get the latest version of our SDK:

```kotlin
dependencies {
    implementation("ai.devrev.sdk:devrev-sdk:<version>")
}
```
2. Our SDK is available on Maven Central. To access it, add `mavenCentral` to your root `build.gradle.kts` file.
```kotlin
repositories {
    mavenCentral()
}
```
After completing these steps in your `build.gradle.kts` Kotlin script, you should be able to import and use the DevRev SDK in your Android application.

</Tab>
<Tab title="Groovy">

1. Add the following dependencies to your app's `build.gradle` file to get the latest version of our SDK:

```groovy
dependencies {
    implementation 'ai.devrev.sdk:devrev-sdk:<version>'
}
```

2. Our SDK is available on Maven Central. To access it, add `mavenCentral` to your root `build.gradle` file.
```groovy
repositories {
    mavenCentral()
}
```
After completing these steps in your `build.gradle` Groovy script, you should be able to import and use the DevRev SDK in your Android application.

</Tab>
</Tabs>

## Set up the DevRev SDK

1. In DevRev, go to **Settings** > **PLuG settings** to obtain **Your unique App ID** (referred to as `supportID` in the code).
2. After obtaining the credentials, you can configure the DevRev SDK in your app. The SDK will be ready for use once you execute the configuration method.
<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.configure(context: Context, appId: String)
```
  </Tab>
  <Tab title="Java">
```java
DevRev.INSTANCE.configure(Context context, String appId);
```
  </Tab>
</Tabs>
3. To configure the SDK, you need to call the following method inside your `Application` class:
**NEED SYNTAX**

<Callout intent="note">
If you don’t have a custom `Application` class, create one as shown below.
</Callout>

<Tabs>
  <Tab title="Kotlin">
```kotlin
import ai.devrev.sdk.DevRev

class FooApplication : Application() {

    override fun onCreate() {
        super.onCreate()
        DevRev.configure(
            context = this,
            appId = "<APP_ID>"
        )
    }
}
```
  </Tab>
  <Tab title="Java">
```java
import ai.devrev.sdk.DevRev;

public class FooApplication extends Application {

    @Override
    public void onCreate() {
        super.onCreate();
        DevRev.INSTANCE.configure(
            this,
            "<APP_ID>"
        );
    }
}
```
  </Tab>
</Tabs>

4. In the `onCreate` method of your `Application`, configure the DevRev SDK with the required parameters using the credentials obtained earlier.
5. Ensure that the custom application is specified in the `AndroidManifest.xml`, as shown below:

```xml
<application
    android:name=".FooApplication">
</application>
```

## Identification

To utilize certain features of the DevRev SDK, user identification is required. You can select from the following methods to identify users within your application:

<Callout intent="note">
The identification function should be placed appropriately in your app after the user logs in. If you have the user information available at app launch, call the function after the `DevRev.configure(context, appID)` method.
</Callout>

### Anonymous identification

The anonymous identification method allows you to create an anonymous user with an optional or random user identifier, ensuring that no other data is stored or associated with the user.

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.identifyAnonymousUser(
    userId: String
)
```
  </Tab>
  <Tab title="Java">
```java
DevRev.INSTANCE.identifyAnonymousUser(
    String userId
);
```
  </Tab>
</Tabs>

For example:

<Tabs>
  <Tab title="Kotlin">
```kotlin
// Identify an anonymous user without a user identifier.
DevRev.identifyAnonymousUser("abcd1234")
```
  </Tab>
  <Tab title="Java">
```java
// Identify an anonymous user without a user identifier.
DevRev.INSTANCE.identifyAnonymousUser("abcd1234");
```
  </Tab>
</Tabs>

### Unverified identification

The unverified identification method identifies users with a unique identifier, but it does not verify their identity with the DevRev backend.

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.identifyUnverifiedUser(
    indentity: Identity
)
```
  </Tab>
  <Tab title="Java">
```java
DevRev.INSTANCE.identifyUnverifiedUser(
    Identity identity
);
```   
  </Tab>
</Tabs>

The function accepts the `Identity` object, where the user identifier (`userId`) is the only required property; all other properties are optional.

For example:

<Tabs>
  <Tab title="Kotlin">
```kotlin
// Identify an unverified user using their email address as the user identifier.
DevRev.identifyUnverifiedUser(Identity(userId = "foo@example.org"))
```
  </Tab>
  <Tab title="Java">
```java
// Identify an unverified user using their email address as the user identifier.
DevRev.identifyUnverifiedUser(
        new Identity("foo@example.org", null, null, null, null, null)
);
```
  </Tab>
</Tabs>

## PLuG support chat

Once user identification is complete, you can start using the chat (conversations) dialog supported by our DevRev SDK. To open the chat dialog, your application should use the `showSupport` API, as shown in the following example:

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.showSupport(context: Context)
```    
  </Tab>
  <Tab title="Java">
```java
DevRevExtKt.showSupport(DevRev.INSTANCE, context);
```    
  </Tab>
</Tabs>

The DevRev SDK also provides a support button, which can be integrated into your application. To include it on the current screen, add the following code to your XML layout:

```xml
<ai.devrev.sdk.plug.view.PlugFloatingActionButton
    android:id="@+id/plug_fab"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_margin="24dp"
    app:layout_constraintBottom_toBottomOf="parent"
    app:layout_constraintEnd_toEndOf="parent" />
```
The support button can be customized using default parameters, enabling you to tailor its appearance to your application's design.

```kotlin
android:src="@your_drawable_here"
```
and

```kotlin
android:backgroundTint="@your_background_color"
```

At this stage, your app should be fully configured to utilize all functionalities of the DevRev PLuG SDK. Pressing the support button will direct the user to the chat interface, enabling effective interaction and support.

## Analytics

The DevRev SDK allows you to send custom analytic events by using a name and a string hashmap. You can track these events using the following function:

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.trackEvent(name: String, properties: HashMap<String, String>)
```
  </Tab>
  <Tab title="Java">
```java
DevRevAnalyticsExtKt.trackEvent(DevRev instance, String name, HashMap<String, String> properties);
```
  </Tab>
</Tabs>

For example:

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.trackEvent(name = "open-message-screen", properties = {"id": "foo-bar-1337"})
```
  </Tab>
  <Tab title="Java">
```java
DevRevAnalyticsExtKt.trackEvent(DevRev.INSTANCE, "open-message-screen", new HashMap<>().put("id", "foo-bar-1337"));
```
  </Tab>
</Tabs>

## Session analytics

The DevRev SDK offers session analytics features to help you understand how users interact with your app.

### Opting In/Out

End users can opt in or out of the session analytics feature, enabling them to control whether their interactions are tracked for analytics.

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.stopAllMonitoring()
```
  </Tab>
  <Tab title="Java">
```java
DevRevObservabilityExtKt.stopAllMonitoring(DevRev.INSTANCE);
```
  </Tab>
</Tabs>

This method terminates and deletes the current session recording and also disables future session recording by our SDK for this user.

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.resumeAllMonitoring()
```
  </Tab>
  <Tab title="Java">
```java
DevRevObservabilityExtKt.resumeAllMonitoring(DevRev.INSTANCE);
```
  </Tab>
</Tabs>

If session recording was disabled for the user using the `stopAllMonitoring()` method, you can enable recording at runtime with this method.

<Callout intent="note">
This feature only stores a monitoring permission flag and does not provide any user interface or dialog.
</Callout>

## Session recording

You can enable session recording to capture user interactions with your app.

<Callout intent="note">
The session recording feature is opt-out and is enabled by default.
</Callout>

Here are the available methods to help you control the session recording feature:

| Kotlin                   | Java                                                               | Action                                                    |
|--------------------------|--------------------------------------------------------------------|-----------------------------------------------------------|
| DevRev.startRecording()  | DevRevObservabilityExtKt.startRecording(DevRev.INSTANCE, context); | Starts the session recording.                             |
| DevRev.stopRecording()   | DevRevObservabilityExtKt.stopRecording(DevRev.INSTANCE);           | Ends the session recording and uploads it to the portal. |
| DevRev.pauseRecording()  | DevRevObservabilityExtKt.pauseRecording(DevRev.INSTANCE);          | Pauses the ongoing session recording.                     |
| DevRev.resumeRecording() | DevRevObservabilityExtKt.resumeRecording(DevRev.INSTANCE);         | Resumes a paused session recording.                       |

## Session properties

You can add custom properties to the session recording to help you understand the context of the session. The properties are defined as a dictionary of string values.

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.addSessionProperties(properties: HashMap<String, Any>)
```    
  </Tab>
  <Tab title="Java">
```java
DevRevObservabilityExtKt.addSessionProperties(DevRev.INSTANCE, HashMap<String, Object> properties);
```    
  </Tab>
</Tabs>

To clear the session properties in scenarios such as user logout or when the session ends, use the following method: 

<Tabs>
  <Tab title="Kotlin">
```kotlin
DevRev.clearSessionProperties()
```
  </Tab>
  <Tab title="Java">
```java
DevRevObservabilityExtKt.clearSessionProperties(DevRev.INSTANCE);
```
  </Tab>
</Tabs>
